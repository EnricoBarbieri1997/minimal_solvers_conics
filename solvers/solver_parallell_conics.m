function sols = solver_parallell_conics(data)
[C0,C1] = setup_elimination_template(data);
C1 = C0 \ C1;
RR = [-C1(end-2:end,:);eye(8)];
AM_ind = [9,6,1,8,2,10,11,3];
AM = RR(AM_ind,:);
[V,D] = eig(AM);
V = V ./ (ones(size(V,1),1)*V(1,:));
sols(1,:) = V(2,:);
sols(2,:) = V(4,:);
sols(3,:) = diag(D).';

% Action =  z
% Quotient ring basis (V) = 1,x,x*z,y,y*z,z,z^2,z^3,
% Available monomials (RR*V) = x*z^2,y*z^2,z^4,1,x,x*z,y,y*z,z,z^2,z^3,
function [coeffs] = compute_coeffs(data)
coeffs(1) = data(1)^2*data(7) + 2*data(1)*data(5) + data(4);
coeffs(2) = -2*data(1)^2*data(5) - 2*data(1)*data(4) + 2*data(1)*data(7) + 2*data(5);
coeffs(3) = data(1)^2*data(4) - 2*data(1)*data(5) + data(7);
coeffs(4) = 2*data(1)^2*data(8) + 2*data(1)*data(6);
coeffs(5) = -2*data(1)^2*data(6) + 2*data(1)*data(8);
coeffs(6) = -data(1)^2;
coeffs(7) = 2*data(1)*data(8) + 2*data(6);
coeffs(8) = -2*data(1)*data(6) + 2*data(8);
coeffs(9) = -2*data(1);
coeffs(10) = -1;
coeffs(11) = data(2)^2*data(12) + 2*data(2)*data(10) + data(9);
coeffs(12) = -2*data(2)^2*data(10) - 2*data(2)*data(9) + 2*data(2)*data(12) + 2*data(10);
coeffs(13) = data(2)^2*data(9) - 2*data(2)*data(10) + data(12);
coeffs(14) = 2*data(2)^2*data(13) + 2*data(2)*data(11);
coeffs(15) = -2*data(2)^2*data(11) + 2*data(2)*data(13);
coeffs(16) = -data(2)^2;
coeffs(17) = 2*data(2)*data(13) + 2*data(11);
coeffs(18) = -2*data(2)*data(11) + 2*data(13);
coeffs(19) = -2*data(2);
coeffs(20) = data(3)^2*data(17) + 2*data(3)*data(15) + data(14);
coeffs(21) = -2*data(3)^2*data(15) - 2*data(3)*data(14) + 2*data(3)*data(17) + 2*data(15);
coeffs(22) = data(3)^2*data(14) - 2*data(3)*data(15) + data(17);
coeffs(23) = 2*data(3)^2*data(18) + 2*data(3)*data(16);
coeffs(24) = -2*data(3)^2*data(16) + 2*data(3)*data(18);
coeffs(25) = -data(3)^2;
coeffs(26) = 2*data(3)*data(18) + 2*data(16);
coeffs(27) = -2*data(3)*data(16) + 2*data(18);
coeffs(28) = -2*data(3);
function [C0,C1] = setup_elimination_template(data)
[coeffs] = compute_coeffs(data);
coeffs0_ind = [1,11,2,1,11,12,20,3,2,12,13,21,3,13,22,1,11,20,4,14,2,1,11,12,20,21,5,4,14,15,3,2,12,13,21,23,22,5,15,3,13,22,24,4,14,11,1,20,23,6,...
16,5,4,14,15,12,2,21,23,24,6,16,5,15,13,3,22,24,25,6,16,14,4,23,25,6,16,15,5,24,25,1,11,20,7,17,2,12,1,20,11,21,8,7,17,18,26,3,13,2,...
21,12,22,8,18,27,3,22,13,7,17,4,14,20,11,1,23,26,9,19,8,7,17,18,26,5,15,4,23,21,12,2,14,24,27,9,19,8,18,27,28,5,24,22,13,3,15,7,17,20,...
11,1,26,10,10,8,18,7,26,21,12,2,17,27,10,10,10,8,27,22,13,3,18,9,19,17,7,26,6,16,23,14,4,25,28,9,19,18,8,27,28,6,25,24,15,5,16,16,6,25];
coeffs1_ind = [10,10,10,10,10,26,17,7,10,10,10,9,19,26,17,7,23,14,4,28,10,10,10,27,18,8,10,10,10,10,9,28,27,18,8,24,15,5,19,10,10,10,28,19,9,10,10,10,28,19,...
9,25,16,6,19,9,28,25,16,6];
C0_ind = [1,4,27,28,29,30,39,53,54,55,56,65,80,81,91,109,112,130,131,134,135,136,137,138,142,156,157,158,159,160,161,162,163,164,168,169,182,184,185,188,189,194,195,213,216,217,218,219,234,235,...
238,239,240,241,242,243,244,245,246,260,262,263,266,267,269,270,271,272,273,291,294,295,296,297,312,318,319,321,322,323,324,352,353,363,365,368,378,379,380,381,388,389,391,392,393,394,403,404,405,406,...
407,414,415,418,419,429,432,433,440,447,450,456,457,460,461,462,467,468,469,472,473,474,475,476,480,482,483,484,485,486,487,488,492,493,494,496,497,500,501,506,507,510,511,512,513,514,518,534,535,541,...
542,543,545,547,550,560,561,562,563,567,568,569,570,571,574,575,585,588,589,593,594,595,596,603,606,607,608,609,612,613,616,617,618,623,624,630,631,633,634,635,636,640,641,642,643,644,648,659,660,661];
C1_ind = [21,22,23,40,41,47,48,49,51,57,60,66,67,70,71,72,73,74,75,77,78,94,95,99,100,101,102,110,111,116,120,121,122,123,124,125,126,127,128,148,149,150,151,152,153,165,166,167,174,175,...
176,177,178,179,191,192,193,200,201,202];
C0 = zeros(26,26);
C1 = zeros(26,8);
C0(C0_ind) = coeffs(coeffs0_ind);
C1(C1_ind) = coeffs(coeffs1_ind);

